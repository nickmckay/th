<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskmaster Accolades Matching Game</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Arial Black', 'Arial Bold', sans-serif;
            background: #982627;
            padding: 0;
            margin: 0;
            min-height: 100vh;
        }

        .hero-section {
            position: relative;
            width: 100%;
            height: 450px;
            background: #982627;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-bottom: 8px solid #DAA520;
        }

        .hero-image-greg-alex {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            z-index: 2;
        }

        .hero-title {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 3;
            color: white;
            font-size: 4em;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.9);
            text-align: center;
            white-space: nowrap;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: #FFF9F0;
            padding: 30px;
            box-shadow: 0 -5px 30px rgba(0, 0, 0, 0.3);
        }

        .task-container {
            position: relative;
            max-width: 600px;
            margin: 20px auto 30px;
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .envelope-wrapper {
            position: relative;
            width: 100%;
            max-width: 500px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .envelope-wrapper:hover {
            transform: scale(1.02);
        }

        .envelope-wrapper.open {
            cursor: default;
        }

        .envelope {
            position: relative;
            width: 100%;
            padding-bottom: 65%;
            background: #FAF9F6;
            border: 3px solid #CCC;
            border-radius: 5px;
            overflow: visible;
            perspective: 1000px;
        }

        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(to bottom, #F5F5F5, #FAF9F6);
            border-left: 3px solid #CCC;
            border-right: 3px solid #CCC;
            clip-path: polygon(0 0, 50% 100%, 100% 0);
            transform-origin: 50% 0%;
            transition: transform 0.8s ease;
            z-index: 3;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .envelope-wrapper.open .envelope-flap {
            transform: rotateX(-180deg);
        }

        .wax-seal {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            z-index: 4;
            transition: transform 0.8s ease, opacity 0.3s ease;
        }

        .envelope-wrapper.open .wax-seal {
            transform: translateX(-50%) rotate(360deg) scale(0.5);
            opacity: 0;
        }

        .task-paper {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, 20%);
            width: 85%;
            padding: 40px 30px;
            background: url('Taskmaster _ WELCOME TO TASKMASTER_files/home-letter.png') center center / contain no-repeat;
            background-size: 100% 100%;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: transform 1s ease, opacity 0.8s ease;
            z-index: 2;
        }

        .envelope-wrapper.open .task-paper {
            transform: translate(-50%, -40%);
            opacity: 1;
            transition-delay: 0.4s;
        }

        .envelope-prompt {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Courier New', 'Courier', monospace;
            font-size: 1.2em;
            color: #8B0000;
            font-weight: bold;
            text-transform: uppercase;
            text-align: center;
            opacity: 1;
            transition: opacity 0.3s ease;
            z-index: 1;
            pointer-events: none;
        }

        .envelope-wrapper.open .envelope-prompt {
            opacity: 0;
        }

        .task-text {
            font-family: 'Courier New', 'Courier', monospace;
            font-size: 1.3em;
            line-height: 1.8;
            color: #000;
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .time-starts {
            margin-top: 15px;
            font-style: italic;
            color: #8B0000;
        }

        .check-button {
            display: block;
            margin: 0 auto 20px;
            padding: 15px 40px;
            font-size: 1.3em;
            font-weight: 900;
            background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
            color: #FFD700;
            border: 3px solid #DAA520;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            width: calc(100% - 40px);
            max-width: 320px;
        }

        .check-button:hover {
            background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .score-display {
            text-align: center;
            font-family: 'Courier New', 'Courier', monospace;
            font-size: 1.5em;
            font-weight: bold;
            color: #8B0000;
            margin: 10px auto 20px;
            padding: 15px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .score-display.perfect {
            color: #28a745;
        }

        .video-reveal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
        }

        .video-reveal.show {
            display: flex;
        }

        .video-container {
            max-width: 90%;
            max-height: 80vh;
            background: #000;
            border: 5px solid #DAA520;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(218, 165, 32, 0.6);
        }

        .video-container video {
            width: 100%;
            height: auto;
            display: block;
        }

        .video-title {
            color: #FFD700;
            font-size: 2em;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.8);
        }

        .game-layout {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            margin-top: 50px;
        }

        .accolades-section {
            flex: 1;
            min-width: 0;
        }

        .accolades-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .accolade-card {
            background: white;
            border: 3px solid #8B0000;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .accolade-card.correct {
            border-color: #28a745;
            background: #d4edda;
            box-shadow: 0 0 15px rgba(40, 167, 69, 0.5);
        }

        .accolade-card.incorrect {
            border-color: #8B0000;
            background: #FFE4E1;
            box-shadow: 0 0 15px rgba(139, 0, 0, 0.4);
        }

        .accolade-card.drag-over {
            background: #FFF9F0;
            border-color: #DAA520;
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(218, 165, 32, 0.4);
        }

        .accolade-text {
            font-size: 0.9em;
            color: #333;
            margin-bottom: 10px;
            flex-grow: 1;
            line-height: 1.4;
        }

        .drop-zone {
            width: 100px;
            height: 100px;
            border: 3px dashed #8B0000;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #FFF9F0;
            flex-shrink: 0;
        }

        .drop-zone.has-image {
            border: 3px solid #DAA520;
            background: white;
        }

        .dropped-image {
            width: 100px;
            height: 100px;
            object-fit: contain;
            cursor: move;
        }

        .images-section {
            width: 400px;
            flex-shrink: 0;
            position: sticky;
            top: 20px;
            align-self: flex-start;
        }

        .images-section h2 {
            text-align: center;
            color: #8B0000;
            margin: 0 0 20px 0;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .images-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: flex-start;
            padding: 20px;
            background: white;
            border: 3px solid #8B0000;
            border-radius: 10px;
            min-height: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .contestant-image {
            width: 100px;
            height: 100px;
            object-fit: contain;
            cursor: move;
            transition: all 0.3s;
        }

        .contestant-image:hover {
            transform: scale(1.05);
            opacity: 0.8;
        }

        .contestant-image.dragging {
            opacity: 0.5;
        }

        .drop-zone-placeholder {
            color: #8B0000;
            font-size: 1.5em;
            text-align: center;
            font-weight: bold;
        }

        @media (max-width: 1024px) {
            .game-layout {
                flex-direction: column;
            }

            .images-section {
                width: 100%;
            }

            .hero-title {
                font-size: 2.5em;
                letter-spacing: 2px;
            }

            .hero-section {
                height: 350px;
            }
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 1.8em;
            }

            .hero-section {
                height: 250px;
            }

            .accolades-grid {
                grid-template-columns: 1fr;
            }

            .task-container {
                margin: 20px auto;
                min-height: 300px;
            }

            .task-paper {
                padding: 30px 20px;
                min-height: 250px;
            }

            .task-text {
                font-size: 1em;
            }

            .envelope-prompt {
                font-size: 0.9em;
            }

            .wax-seal {
                width: 60px;
                height: 60px;
            }

            .check-button {
                font-size: 1.1em;
                padding: 12px 30px;
            }
        }
    </style>
</head>
<body>
    <div class="hero-section">
        <img src="GregAndAlex.webp" alt="Greg and Alex" class="hero-image-greg-alex">
    </div>

    <div class="container">
        <div class="task-container">
            <div class="envelope-wrapper" id="envelopeWrapper" onclick="openEnvelope()">
                <div class="envelope">
                    <div class="envelope-flap"></div>
                </div>
                <img src="Taskmaster _ WELCOME TO TASKMASTER_files/letter-seal.png" alt="Wax Seal" class="wax-seal">
                <div class="envelope-prompt">Click to open task</div>
                <div class="task-paper">
                    <div class="task-text">
                        Match each contestant<br>
                        to their correct accolades.<br><br>
                        These rankings are for<br>
                        series 1 through 17.<br><br>
                        <span class="time-starts">Your time starts now.</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-layout">
            <div class="accolades-section">
                <div class="accolades-grid" id="accoladesGrid"></div>
            </div>

            <div class="images-section">
                <div class="score-display" id="scoreDisplay"></div>
                <h2>Contestants</h2>
                <div class="images-bank" id="imagesBank"></div>
            </div>
        </div>
    </div>

    <div class="video-reveal" id="videoReveal">
        <div class="video-title">Perfect Score! Your Next Clue:</div>
        <div class="video-container">
            <video id="clueVideo" controls>
                <source src="spyClue.mov" type="video/quicktime">
                <source src="spyClue.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>

    <script>
        // Parse the CSV data
        const accoladesData = {
            "Josh W": ["2nd Lowest Scoring Winner (94)"],
            "Joe W": ["1st Worst Score% (14.6% of possible points)", "1st Worst Live Tasks (13.3%)"],
            "Katherine R": ["1st (tied) Best Episode Score (30)"],
            "Richard O": ["1st Least Consistent Scores (32.7%)", "2nd Worst Episode Score (5)", "3rd Best Episode Score (27)"],
            "Paul C": ["1st Fewest Points (66)"],
            "Rob B": ["1st Lowest Scoring Winner (87)"],
            "Hugh D": ["1st (tied) Best Team (33.3%)", "1st Worst Prizes (10.9%)"],
            "Lolly A": ["1st Best Prizes (28.6%)", "1st (tied) Worst Team (11.1%)", "1st Youngest Contestant (26.6)"],
            "Mel G": ["1st (tied) Best Team (33.3%)", "1st Worst Episode Score (3)"],
            "Noel F": ["1st Best at Subjective Tasks (26.2%)", "1st (tied) Worst Team (11.1%)"],
            "Joe L": ["1st (tied) Worst Team (11.1%)"],
            "Bob M": ["2nd (tied) Most Episode Wins (50%)", "3rd Lowest Scoring Winner (138)"],
            "Nish K": ["1st Most Episode Losses (75%)"],
            "Alice L": ["1st Highest Scoring Loser (152)", "3rd (tied) Worst Episode Score (6)"],
            "James A": ["3rd (tied) Longest Win Streak (4)", "3rd (tied) Most Episode Wins (40%)", "3rd Most Episodes Named (3)"],
            "Jessica K": ["Stage named after them"],
            "Phil W": ["1st Worst at Objective tasks (13.5%)"],
            "Iain S": ["1st (tied) Most Disqualifications (9)"],
            "Lou S": ["1st Best Live Tasks (29.7%)", "2nd (tied) Most Episode Wins (50%)"],
            "David B": ["1st (tied) Most Last Places (47.1%)"],
            "Ed G": ["3rd (tied) Longest Win Streak (4)", "3rd (tied) Most Episode Wins (40%)"],
            "Katherine P": ["1st (tied) Most Disqualifications (9)", "1st Longest Losing Streak (6)", "1st (tied) Most Last Places (47.1%)", "3rd (tied) Worst Episode Score (6)"],
            "Richard H": ["1st Most Episode Wins (60%)"],
            "Morgana R": ["1st Most Bonus Points (9)", "1st Lowest Value Winner (20.8%)"],
            "Victoria CM": ["2nd Worst Score% (14.8%)", "2nd Most Episode Losses (70%)", "3rd Worst at Subjective (15.1%)", "3rd Worst Prizes (13.9%)", "3rd Worst Live Tasks (14.1%)"],
            "Chris R": ["2nd (tied) Most Episode Wins (50%)"],
            "Sophie D": ["2nd (tied) Best Episode Score (28)"],
            "Dara OB": ["1st (tied) Best Episode Score (30)", "1st Longest Win Streak (7)", "1st Most First Places (40.4%)", "2nd Most Points (184)"],
            "Ivo G": ["1st (tied) Most Disqualifications (9)", "2nd Longest Losing Streak (5)", "2nd Most Episodes Named (4)"],
            "Jenny E": ["2nd Oldest Contestant (63.1)", "3rd Best Live Tasks (27.3%)"],
            "Mae M": ["2nd (tied) Best Episode Score (28)", "3rd Most Disqualifications (7)", "3rd (tied) Most Episode Wins (40%)"],
            "Julian C": ["1st Oldest Contestant (64.4)"],
            "John R": ["1st Most Points (192)", "1st Best at Objective (26.2%)"]
        };

        // Initialize the game
        let droppedImages = {}; // Track which image is in which accolade card

        // Open envelope function
        function openEnvelope() {
            const envelope = document.getElementById('envelopeWrapper');
            if (!envelope.classList.contains('open')) {
                envelope.classList.add('open');
            }
        }

        // Function to get the best rank for a contestant
        function getBestRank(accolades) {
            for (const accolade of accolades) {
                if (accolade.startsWith('1st')) return 1;
            }
            for (const accolade of accolades) {
                if (accolade.startsWith('2nd')) return 2;
            }
            for (const accolade of accolades) {
                if (accolade.startsWith('3rd')) return 3;
            }
            return 4; // For "Stage named after them" and other special cases
        }

        // Sort contestants by their best rank
        function getSortedContestants() {
            return Object.entries(accoladesData).sort((a, b) => {
                const rankA = getBestRank(a[1]);
                const rankB = getBestRank(b[1]);
                if (rankA !== rankB) {
                    return rankA - rankB;
                }
                // If same rank, sort alphabetically
                return a[0].localeCompare(b[0]);
            });
        }

        function initGame() {
            const grid = document.getElementById('accoladesGrid');
            const bank = document.getElementById('imagesBank');

            // Create accolade cards in sorted order
            const sortedContestants = getSortedContestants();
            sortedContestants.forEach(([name, accolades], index) => {
                const card = document.createElement('div');
                card.className = 'accolade-card';
                card.dataset.contestant = name;
                card.dataset.index = index;

                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone';
                dropZone.dataset.dropzone = index;
                dropZone.innerHTML = '<div class="drop-zone-placeholder">?</div>';

                // Add drag and drop event listeners
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('drop', handleDrop);
                dropZone.addEventListener('dragleave', handleDragLeave);

                const accoladeText = document.createElement('div');
                accoladeText.className = 'accolade-text';
                accoladeText.innerHTML = accolades.map(a => `â€¢ ${a}`).join('<br>');

                card.appendChild(dropZone);
                card.appendChild(accoladeText);
                grid.appendChild(card);
            });

            // Create contestant images
            Object.keys(accoladesData).forEach(name => {
                const img = document.createElement('img');
                img.src = `extracted_images/${name}.png`;
                img.className = 'contestant-image';
                img.draggable = true;
                img.dataset.contestant = name;

                img.addEventListener('dragstart', handleDragStart);
                img.addEventListener('dragend', handleDragEnd);

                bank.appendChild(img);
            });

            // Make the bank accept drops to return images
            bank.addEventListener('dragover', handleBankDragOver);
            bank.addEventListener('drop', handleBankDrop);
            bank.addEventListener('dragleave', handleBankDragLeave);
        }

        function handleDragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', e.target.dataset.contestant);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            e.currentTarget.closest('.accolade-card').classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.closest('.accolade-card').classList.remove('drag-over');
        }

        function handleBankDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            e.currentTarget.style.background = '#e3f2fd';
        }

        function handleBankDragLeave(e) {
            e.currentTarget.style.background = 'white';
        }

        function handleBankDrop(e) {
            e.preventDefault();
            const bank = e.currentTarget;
            bank.style.background = 'white';

            const contestant = e.dataTransfer.getData('text/plain');

            // Find and remove from any drop zone
            Object.keys(droppedImages).forEach(zoneIndex => {
                if (droppedImages[zoneIndex] === contestant) {
                    // Clear the drop zone
                    const dropZone = document.querySelector(`[data-dropzone="${zoneIndex}"]`);
                    if (dropZone) {
                        dropZone.innerHTML = '<div class="drop-zone-placeholder">?</div>';
                        dropZone.classList.remove('has-image');
                        // Clear any highlighting on the card
                        const card = dropZone.closest('.accolade-card');
                        if (card) {
                            card.classList.remove('correct', 'incorrect');
                        }
                    }
                    // Remove from tracking
                    delete droppedImages[zoneIndex];
                }
            });

            // Find the dragged image and remove it
            const draggedImg = document.querySelector(`[data-contestant="${contestant}"].dragging`) ||
                               document.querySelector(`[data-contestant="${contestant}"].dropped-image`);

            if (draggedImg) {
                draggedImg.remove();
            }

            // Add image back to bank
            const newImg = document.createElement('img');
            newImg.src = `extracted_images/${contestant}.png`;
            newImg.className = 'contestant-image';
            newImg.draggable = true;
            newImg.dataset.contestant = contestant;

            newImg.addEventListener('dragstart', handleDragStart);
            newImg.addEventListener('dragend', handleDragEnd);

            bank.appendChild(newImg);

            // Recheck answers
            checkAnswers();
        }

        function handleDrop(e) {
            e.preventDefault();
            const card = e.currentTarget.closest('.accolade-card');
            card.classList.remove('drag-over');
            card.classList.remove('correct', 'incorrect');

            const contestant = e.dataTransfer.getData('text/plain');
            const dropZone = e.currentTarget;
            const zoneIndex = dropZone.dataset.dropzone;

            // If there's already an image in this zone, return it to the bank
            if (droppedImages[zoneIndex]) {
                const existingImg = dropZone.querySelector('.dropped-image');
                if (existingImg) {
                    returnToBank(existingImg);
                }
            }

            // Remove the dragged image from wherever it was
            const draggedImg = document.querySelector(`[data-contestant="${contestant}"].dragging`) ||
                               document.querySelector(`[data-contestant="${contestant}"].dropped-image`);

            if (draggedImg) {
                // If it was in another drop zone, remove it from that tracking
                Object.keys(droppedImages).forEach(key => {
                    if (droppedImages[key] === contestant) {
                        delete droppedImages[key];
                    }
                });

                // Create new image in the drop zone
                dropZone.innerHTML = '';
                const newImg = document.createElement('img');
                newImg.src = `extracted_images/${contestant}.png`;
                newImg.className = 'dropped-image';
                newImg.draggable = true;
                newImg.dataset.contestant = contestant;

                newImg.addEventListener('dragstart', handleDragStart);
                newImg.addEventListener('dragend', handleDragEnd);

                dropZone.appendChild(newImg);
                dropZone.classList.add('has-image');

                // Track the placement
                droppedImages[zoneIndex] = contestant;

                // Remove from bank if it was there
                draggedImg.remove();
            }

            // Automatically check answers after placing an image
            checkAnswers();
        }

        function returnToBank(img) {
            const bank = document.getElementById('imagesBank');
            const contestant = img.dataset.contestant;

            const newImg = document.createElement('img');
            newImg.src = `extracted_images/${contestant}.png`;
            newImg.className = 'contestant-image';
            newImg.draggable = true;
            newImg.dataset.contestant = contestant;

            newImg.addEventListener('dragstart', handleDragStart);
            newImg.addEventListener('dragend', handleDragEnd);

            bank.appendChild(newImg);
        }

        function checkAnswers() {
            const cards = document.querySelectorAll('.accolade-card');
            const scoreDisplay = document.getElementById('scoreDisplay');
            let correct = 0;
            let total = 0;

            cards.forEach(card => {
                const correctContestant = card.dataset.contestant;
                const cardIndex = card.dataset.index;
                const droppedContestant = droppedImages[cardIndex];

                if (droppedContestant) {
                    total++;
                    if (droppedContestant === correctContestant) {
                        card.classList.remove('incorrect');
                        card.classList.add('correct');
                        correct++;
                    } else {
                        card.classList.remove('correct');
                        card.classList.add('incorrect');
                    }
                } else {
                    card.classList.remove('correct', 'incorrect');
                }
            });

            if (total > 0) {
                const totalContestants = Object.keys(accoladesData).length;
                scoreDisplay.textContent = `${correct} / ${totalContestants}`;

                if (correct === totalContestants) {
                    scoreDisplay.classList.add('perfect');
                    // Show the video reveal
                    showVideo();
                } else {
                    scoreDisplay.classList.remove('perfect');
                }
            } else {
                scoreDisplay.textContent = 'Drop some images first!';
                scoreDisplay.classList.remove('perfect');
            }
        }

        function showVideo() {
            const videoReveal = document.getElementById('videoReveal');
            const video = document.getElementById('clueVideo');

            videoReveal.classList.add('show');

            // Play the video automatically when revealed
            video.play().catch(err => {
                console.log('Autoplay prevented, user can click play manually');
            });
        }

        // Initialize the game when page loads
        initGame();
    </script>
</body>
</html>